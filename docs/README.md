# Docs - Threat Intelligence Bot

- [Docs - Threat Intelligence Bot](#docs---threat-intelligence-bot)
- [1. Báº£ng Ä‘iá»u khiá»ƒn](#1-báº£ng-Ä‘iá»u-khiá»ƒn)
- [2. TrÃ¬nh Quáº£n lÃ½ khÃ³a](#2-trÃ¬nh-quáº£n-lÃ½-khÃ³a)
  - [2.1. ThÃªm má»›i khÃ³a VirusTotal](#21-thÃªm-má»›i-khÃ³a-virustotal)
  - [2.2. Xuáº¥t thÃ´ng tin khÃ³a VirusTotal](#22-xuáº¥t-thÃ´ng-tin-khÃ³a-virustotal)
  - [2.3. Báº­t khÃ³a VirusTotal](#23-báº­t-khÃ³a-virustotal)
  - [2.4. XÃ³a khÃ³a VirusTotal](#24-xÃ³a-khÃ³a-virustotal)
  - [2.5. Táº£i vá» khÃ³a VirusTotal](#25-táº£i-vá»-khÃ³a-virustotal)
- [3. Quáº£n lÃ½ Member](#3-quáº£n-lÃ½-member)
  - [3.1. Admin cáº¥p VIP cho Member](#31-admin-cáº¥p-vip-cho-member)
  - [3.2. Admin kiá»ƒm tra tráº¡ng thÃ¡i VIP cá»§a Member](#32-admin-kiá»ƒm-tra-tráº¡ng-thÃ¡i-vip-cá»§a-member)
  - [3.3. Admin Thu há»“i VIP cá»§a Member](#33-admin-thu-há»“i-vip-cá»§a-member)
  - [3.4. Lá»‹ch sá»­ truy váº¥n cá»§a VIP Member](#34-lá»‹ch-sá»­-truy-váº¥n-cá»§a-vip-member)
  - [3.5. Gia háº¡n VIP Member](#35-gia-háº¡n-vip-member)
- [4. NhÃ³m chá»©c nÄƒng cho VIP Member](#4-nhÃ³m-chá»©c-nÄƒng-cho-vip-member)
  - [4.1. Download tá»‡p tin tá»« VT](#41-download-tá»‡p-tin-tá»«-vt)
  - [4.2. VirusTotal Intelligence Search](#42-virustotal-intelligence-search)
- [5. Sá»­ dá»¥ng nhÃ³m tÃ­nh nÄƒng VT Enterprise](#5-sá»­-dá»¥ng-nhÃ³m-tÃ­nh-nÄƒng-vt-enterprise)
  - [5.1. Kiá»ƒm tra khÃ³a Ä‘ang dÃ¹ng hay khÃ³a báº¥t ká»³](#51-kiá»ƒm-tra-khÃ³a-Ä‘ang-dÃ¹ng-hay-khÃ³a-báº¥t-ká»³)
  - [5.2. Download tá»‡p tin tá»« VT](#52-download-tá»‡p-tin-tá»«-vt)
  - [5.3. VirusTotal Intelligence Search](#53-virustotal-intelligence-search)
- [6. Sá»­ dá»¥ng Shodan Search Engine](#6-sá»­-dá»¥ng-shodan-search-engine)
  - [6.1. ThÃªm hoáº·c XÃ³a Shodan API Key](#61-thÃªm-hoáº·c-xÃ³a-shodan-api-key)
  - [6.2. Kiá»ƒm tra thÃ´ng tin Shodan API Key](#62-kiá»ƒm-tra-thÃ´ng-tin-shodan-api-key)
  - [6.3. TÃ¬m kiáº¿m má»™t IP hay má»™t Host trÃªn Shodan](#63-tÃ¬m-kiáº¿m-má»™t-ip-hay-má»™t-host-trÃªn-shodan)
  - [6.4. TÃ¬m kiáº¿m cÃ¡c SubDomain trÃªn Shodan](#64-tÃ¬m-kiáº¿m-cÃ¡c-subdomain-trÃªn-shodan)
  - [6.5. Domain to IP vÃ  IP to Domain](#65-domain-to-ip-vÃ -ip-to-domain)
  - [6.6. TÃ¬m kiáº¿m nÃ¢ng cao vá»›i cÃ¡c bá»™ lá»c trÃªn Shodan](#66-tÃ¬m-kiáº¿m-nÃ¢ng-cao-vá»›i-cÃ¡c-bá»™-lá»c-trÃªn-shodan)
- [7. VT Hunting](#7-vt-hunting)
  - [7.1. Khá»Ÿi táº¡o cÃ¡c Hunting Job](#71-khá»Ÿi-táº¡o-cÃ¡c-hunting-job)
  - [7.2. Cáº¥u hÃ¬nh vÃ  khá»Ÿi cháº¡y cÃ¡c Hunting Job](#72-cáº¥u-hÃ¬nh-vÃ -khá»Ÿi-cháº¡y-cÃ¡c-hunting-job)
  - [7.3. Cáº­p nháº­t cÃ¡c thay Ä‘á»•i cá»§a Hunting Job](#73-cáº­p-nháº­t-cÃ¡c-thay-Ä‘á»•i-cá»§a-hunting-job)



# 1. Báº£ng Ä‘iá»u khiá»ƒn

Báº£ng Ä‘iá»u khiá»ƒn cá»§a **Threat Intelligence Bot** lÃ  má»™t menu giá»›i thiá»‡u táº¥t cáº£ tÃ­nh nÄƒng hiá»‡n sáºµn cÃ³ cá»§a Bot. Äá»ƒ show báº£ng Ä‘iá»u khiá»ƒn chÃºng ta gá»­i lá»‡nh:

```bash
/help
```

![img/Untitled.png](img/Untitled.png)

Táº¡i Ä‘Ã¢y chÃºng ta cÃ³ cÃ¡c nhÃ³m tÃ­nh nÄƒng Ä‘Æ°á»£c phÃ¢n loáº¡i theo cÃ¡c `command` riÃªng biá»‡t. VÃ­ dá»¥ nhÃ³m tÃ­nh nÄƒng nÃ¢ng cao dÃ nh cho ngÆ°á»i dÃ¹ng cÃ³ **Premium/Private VirusTotal API Key** cÃ³ command lÃ : `/etp`

Äá»ƒ hiá»ƒn thá»‹ trá»£ giÃºp cho má»™t nhÃ³m tÃ­nh nÄƒng báº¥t ká»³. ChÃºng ta gá»­i lá»‡nh theo cÃº phÃ¡p: `</command>` hoáº·c `</command> help`. VÃ­ dá»¥:

```bash
/etp
# Hoáº·c
/etp help
```

![img/Untitled%201.png](img/Untitled%201.png)

ğŸ’¡ Máº¸O khi sá»­ dá»¥ng Bot: Chá»‰ cáº§n gÃµ `/` vÃ  **má»™t vÃ i kÃ½ tá»± Ä‘áº§u** tiÃªn cá»§a `command` sau Ä‘Ã³ nháº¥n phÃ­m `TAB` trÃªn bÃ n phÃ­m. Khi Ä‘Ã³ Bot sáº½ tá»± Ä‘á»™ng hoÃ n thÃ nh `command` mÃ  báº¡n khÃ´ng nháº¥t thiáº¿t pháº£i gÃµ toÃ n bá»™ command.


# 2. TrÃ¬nh Quáº£n lÃ½ khÃ³a

Äá»ƒ cÃ³ thá»ƒ sá»­ dá»¥ng Bot, viá»‡c Ä‘áº§u tiÃªn cáº§n pháº£i lÃ m Ä‘Ã³ lÃ  **thiáº¿t láº­p khÃ³a cÃ¡ nhÃ¢n** vá»›i Bot. Hiá»‡n táº¡i Bot Ä‘Ã£ há»— trá»£ Ä‘a ngÆ°á»i dÃ¹ng, má»—i khÃ³a cÃ¡ nhÃ¢n sáº½ Ä‘Æ°á»£c Ä‘á»‹nh danh kÃ¨m vá»›i Telegram UserID. NhÆ° váº­y vá»›i má»—i tÃ i khoáº£n ngÆ°á»i dÃ¹ng Telegram **cÃ³ thá»ƒ thiáº¿t láº­p nhiá»u khÃ³a** VirusTotal nhÆ°ng cÃ¡c khÃ³a nÃ y **khÃ´ng Ä‘Æ°á»£c trÃ¹ng nhau**. Báº¯t Ä‘áº§u thiáº¿t láº­p khÃ³a vá»›i Bot, báº¡n nháº­p lá»‡nh sau Ä‘á»ƒ nháº­n trá»£ giÃºp:

```bash
/key help
```

![img/Untitled%202.png](img/Untitled%202.png)

## 2.1. ThÃªm má»›i khÃ³a VirusTotal

Äá»ƒ thÃªm má»›i má»™t khÃ³a VirusTotal. Báº¡n sá»­ dá»¥ng lá»‡nh: `/key add <key>`. Trong Ä‘Ã³: Tham sá»‘ `add` lÃ  hÃ nh Ä‘á»™ng thá»±c hiá»‡n vÃ  `<key>` lÃ  chuá»—i giÃ¡ trá»‹ khÃ³a VirusTotal cá»§a báº¡n. VÃ­ dá»¥:

```bash
/key add <your-api-key>
```

![img/Untitled%203.png](img/Untitled%203.png)

TrÆ°á»ng há»£p báº¡n cung cáº¥p khÃ³a VT khÃ´ng há»£p lá»‡ hoáº·c khÃ³a Ä‘Ã£ Ä‘Æ°á»£c thÃªm trÆ°á»›c Ä‘Ã³, Bot sáº½ thÃ´ng bÃ¡o nhÆ° hÃ¬nh trÃªn.

## 2.2. Xuáº¥t thÃ´ng tin khÃ³a VirusTotal

Äá»ƒ kiá»ƒm tra thÃ´ng tin vá» cÃ¡c khÃ³a VT mÃ  báº¡n Ä‘Ã£ thÃªm. Gá»­i lá»‡nh sau cho Bot:

```bash
# Xuáº¥t thÃ´ng tin táº¥t cáº£ khÃ³a VirusTotal Ä‘Ã£ thiáº¿t láº­p:
/key dump

# Xuáº¥t thÃ´ng tin cá»¥ thá»ƒ má»™t khÃ³a VirusTotal Ä‘Ã£ thiáº¿t láº­p:
/key dump <your-api-key>
```

![img/Untitled%204.png](img/Untitled%204.png)

GiÃ¡ trá»‹ `is_private` cho biáº¿t khÃ³a Ä‘Ã³ thuá»™c loáº¡i nÃ o: 

- `"is_private": 1` â‡’ Cho biáº¿t Ä‘Ã¢y lÃ  **Private VT Key**
- `"is_private": 0` â‡’ Cho biáº¿t Ä‘Ã¢y lÃ  **Public VT Key**

GiÃ¡ trá»‹ `is_enable` cho biáº¿t tráº¡ng thÃ¡i cá»§a khÃ³a Ä‘Ã³:

- `"is_enable": 1` â‡’ Cho biáº¿t khÃ³a Ä‘ang Ä‘Æ°á»£c **Báº¬T**
- `"is_enable": 0` â‡’ Cho biáº¿t khÃ³a Ä‘ang bá»‹ **Táº®T**

## 2.3. Báº­t khÃ³a VirusTotal

Theo máº·c Ä‘á»‹nh, sau khi thiáº¿t láº­p khÃ³a VT vá»›i Bot thÃ¬ khÃ³a Ä‘Ã³ á»Ÿ tráº¡ng thÃ¡i bá»‹ **Táº®T** (tá»©c lÃ : `"is_enable": 0`). Äá»ƒ báº¯t Ä‘áº§u sá»­ dá»¥ng cÃ¡c tÃ­nh nÄƒng cá»§a Bot, cáº§n pháº£i **Báº¬T** má»™t khÃ³a lÃªn. Gá»­i lá»‡nh sau cho Bot:

```bash
/key enable <your-api-key>
```

![img/Untitled%205.png](img/Untitled%205.png)

GiÃ¡ trá»‹ `is_enable` chuyá»ƒn sang `1` bÃ¡o hiá»‡u khÃ³a VT Ä‘Ã£ Ä‘Æ°á»£c báº­t.

ğŸ’¡ **LÆ°u Ã½:** Táº¡i má»™t thá»i Ä‘iá»ƒm chá»‰ cÃ³ **duy nháº¥t** má»™t khÃ³a VT Ä‘Æ°á»£c Báº¬T. Khi báº¡n cá»‘ gáº¯ng Báº¬T má»™t khÃ³a khÃ¡c lÃªn thÃ¬ khÃ³a Ä‘c báº­t trÆ°á»›c Ä‘Ã³ sáº½ chuyá»ƒn sang tráº¡ng thÃ¡i Táº®T.


## 2.4. XÃ³a khÃ³a VirusTotal

Äá»ƒ xÃ³a khÃ³a VT Ä‘Ã£ thiáº¿t láº­p vá»›i Bot trÆ°á»›c Ä‘Ã³. Báº¡n gá»­i lá»‡nh sau cho Bot:

```bash
# XÃ³a má»™t khÃ³a VT Ä‘Ã£ thÃªm trÆ°á»›c Ä‘Ã³:
/key del <your-api-key>

# XÃ³a táº¥t cáº£ cÃ¡c khÃ³a cÃ³ trong danh sÃ¡ch:
/key del
```

![img/Untitled%206.png](img/Untitled%206.png)

## 2.5. Táº£i vá» khÃ³a VirusTotal

Äá»ƒ tiá»‡n lá»£i cho viá»‡c lÆ°u trá»¯ cÃ¡c khÃ³a Ä‘Ã£ thiáº¿t láº­p vá»›i Bot. Báº¡n cÃ³ thá»ƒ táº£i vá» tá»‡p tin chá»©a cáº¥u hÃ¬nh cÃ¡c khÃ³a. Gá»­i lá»‡nh sau cho Bot:

```bash
/key export
```

![img/Untitled%207.png](img/Untitled%207.png)

BÃ¢y giá» báº¡n Ä‘Ã£ cÃ³ thá»ƒ táº£i vá» file cáº¥u hÃ¬nh cÃ¡c khÃ³a VT vÃ  lÆ°u nÃ³ á»Ÿ má»™t nÆ¡i an toÃ n trÃªn mÃ¡y tÃ­nh cá»§a báº¡n.

# 3. Quáº£n lÃ½ Member

Äá»ƒ linh Ä‘á»™ng trong quÃ¡ trÃ¬nh sá»­ dá»¥ng Bot. NgÆ°á»i dÃ¹ng sá»Ÿ há»¯u khÃ³a **VT Private** (sau Ä‘Ã¢y gá»i lÃ  **Admin**) cÃ³ thá»ƒ cáº¥p má»™t sá»‘ quyá»n mÃ  chá»‰ cÃ³ Private Key má»›i cÃ³ cho ngÆ°á»i dÃ¹ng chá»‰ sá»Ÿ há»¯u khÃ³a **VT Public** (sau Ä‘Ã¢y gá»i lÃ  **Member**). Hiá»‡n táº¡i Bot há»— trá»£ cáº¥p quyá»n `download` má»™t tá»‡p tin tá»« VT cho Member theo `02` hÃ¬nh thá»©c sau, gá»i chung lÃ  cáº¥p `VIP` ğŸ¤£:

1. **Cáº¥p VIP theo ngÃ y**: Member trong thá»i háº¡n sá»­ dá»¥ng cá»§a mÃ¬nh tÃ­nh theo ngÃ y cÃ³ thá»ƒ download khÃ´ng giá»›i háº¡n sá»‘ láº§n tá»« VT.
2. **Cáº¥p VIP theo sá»‘ láº§n request**: Member sá»­ dá»¥ng sá»‘ láº§n download trong pháº¡m vi Ä‘c cáº¥p, náº¿u download bá»‹ lá»—i Member váº«n Ä‘Æ°á»£c báº£o toÃ n lÆ°á»£t download Ä‘Ã³ mÃ  khÃ´ng bá»‹ trá»«. Náº¿u háº¿t sá»‘ lÆ°á»£t download, Member liÃªn há»‡ Admin Ä‘á»ƒ cáº¥p tiáº¿p.

Giao diá»‡n chá»©c nÄƒng VIP cá»§a **Admin**:

![img/Untitled%208.png](img/Untitled%208.png)

Giao diá»‡n chá»©c nÄƒng VIP cá»§a **Member**:

![img/Untitled%209.png](img/Untitled%209.png)

## 3.1. Admin cáº¥p VIP cho Member

Member muá»‘n Ä‘Æ°á»£c cáº¥p VIP cáº§n liÃªn há»‡ vÃ  gá»­i cho **Admin** thÃ´ng tin vá» khÃ³a VT Public cá»§a mÃ¬nh kÃ¨m Telegram UserID. Member thá»±c hiá»‡n cÃ¡c bÆ°á»›c sau:

1. ThÃªm má»›i khÃ³a VT
2. Xuáº¥t thÃ´ng tin khÃ³a VT
3. Gá»­i thÃ´ng tin khÃ³a Public VT Ä‘Ã£ thÃªm cho Admin. VÃ­ dá»¥:

```json
[
    {
        "api_key": "1111111111111111111111111111111111111111111111111111111111111111",
        "chat_id": "775551874",
        "username": "lehonghai",
        "is_private": 0,
        "is_enable": 1
    }
]
```

Admin sau khi cÃ³ Ä‘Æ°á»£c thÃ´ng tin gá»“m: `api_key` vÃ  `chat_id` cá»§a Member. CÃ³ thá»ƒ lá»±a chá»n cÃ¡c phÆ°Æ¡ng thá»©c cáº¥p `VIP` sau:

**3.1.1. Cáº¥p VIP theo sá»‘ ngÃ y cho má»™t Member:**

```bash
/vip day <number> <api_key> <chat_id>
```

**Trong Ä‘Ã³:**

- `<number>`: Sá»‘ ngÃ y muá»‘n cáº¥p cho Member
- `<api_key>`: KhÃ³a VT Public cá»§a Member
- `<chat_id>`: Telegram UserID cá»§a Member

Demo: **Cáº¥p VIP 03 ngÃ y** cho Member

![img/Untitled%2010.png](img/Untitled%2010.png)

**3.1.2. Cáº¥p VIP theo sá»‘ lÆ°á»£t truy váº¥n cho Member**

```bash
/vip req <number> <api_key> <chat_id>
```

**Trong Ä‘Ã³:**

- `<number>`: Sá»‘ lÆ°á»£t truy váº¥n muá»‘n cáº¥p cho Member
- `<api_key>`: KhÃ³a VT Public cá»§a Member
- `<chat_id>`: Telegram UserID cá»§a Member

Demo: **Cáº¥p VIP 10 lÆ°á»£t** truy váº¥n (download) cho Member

![img/Untitled%2011.png](img/Untitled%2011.png)

## 3.2. Admin kiá»ƒm tra tráº¡ng thÃ¡i VIP cá»§a Member

Táº¡i giao diá»‡n chá»©c nÄƒng VIP cá»§a Admin. Äá»ƒ kiá»ƒm tra tráº¡ng thÃ¡i VIP cá»§a cÃ¡c Member cÅ©ng nhÆ° má»©c Ä‘á»™ Ä‘Ã£ sá»­ dá»¥ng cá»§a Member. Gá»­i lá»‡nh sau cho Bot:

```bash
# Kiá»ƒm tra tráº¡ng thÃ¡i cá»§a má»™t Member
/vip dump <api_key>

# Hoáº·c: Kiá»ƒm tra tráº¡ng thÃ¡i cá»§a táº¥t cáº£ Member
/vip dump
```

![img/Untitled%2012.png](img/Untitled%2012.png)

Trong Ä‘Ã³:

- `member_key`: KhÃ³a VT cá»§a Member
- `member_chat_id`: Telegram UserID cá»§a Member
- `member_username`: Telegram Username cá»§a Member
- `admin_username`: Telegram Username cá»§a Admin
- `member_type`: Loáº¡i VIP Member (`datetime`: VIP theo ngÃ y, `requests`: VIP theo lÆ°á»£t download)
- `member_start_time`, `member_end_time`: Thá»i gian báº¯t Ä‘áº§u vÃ  káº¿t thÃºc VIP cá»§a Member
- `member_query_used`, `member_query_allowed`: Sá»‘ lÆ°á»£t download Ä‘Ã£ dÃ¹ng vÃ  tá»•ng sá»‘ lÆ°á»£t download cá»§a Member

## 3.3. Admin Thu há»“i VIP cá»§a Member

Äá»ƒ ngá»«ng cáº¥p VIP cho má»™t Member. Admin tiáº¿n hÃ nh gá»­i lá»‡nh sau:

```bash
/vip del <api_key> <chat_id>
```

![img/Untitled%2013.png](img/Untitled%2013.png)

## 3.4. Lá»‹ch sá»­ truy váº¥n cá»§a VIP Member

Bot hiá»‡n Ä‘Ã£ cÃ³ tÃ­nh nÄƒng theo dÃµi hoáº¡t Ä‘á»™ng cá»§a VIP Member. Admin cÃ³ thá»ƒ sá»­ dá»¥ng tÃ­nh nÄƒng nÃ y Ä‘á»ƒ theo dÃµi sá»‘ láº§n truy váº¥n thÃ nh cÃ´ng, tháº¥t báº¡i cá»§a Member. Biáº¿t Ä‘Æ°á»£c Member Ä‘Ã£ search nhá»¯ng gÃ¬ vÃ  download nhá»¯ng tá»‡p nÃ o.

Gá»­i lá»‡nh sau Ä‘á»ƒ nháº­n Menu trá»£ giÃºp tá»« Bot

```bash
/vip
# Hoáº·c
/vip help
```

![Untitled](img/Untitled%2014.png)

CÃ³ 02 hÃ¬nh thá»©c xem láº¡i lá»‹ch sá»­ truy váº¥n cá»§a Member nhÆ° sau:

- Xem logs cá»§a táº¥t cáº£ Member mÃ  mÃ¬nh Ä‘ang quáº£n lÃ½. CÃº phÃ¡p: `/vip log`
- Xem logs cá»§a má»™t Member cá»¥ thá»ƒ theo Telegram Username. CÃº phÃ¡p: `/vip log <username>`

VÃ  theo máº·c Ä‘á»‹nh thÃ¬ Bot sáº½ gá»­i vá» káº¿t quáº£ cá»§a 20 báº£n ghi logs gáº§n nháº¥t theo thá»© tá»± thá»i gian tá»« cÅ© nháº¥t â‡’ má»›i nháº¥t.

**3.4.1. Xem logs cá»§a táº¥t cáº£ Member:**

```bash
/vip log
```

![Untitled](img/Untitled%2015.png)

**3.4.2. Xem logs cá»§a má»™t Member:**

```bash
/vip log lehonghai
```

![Untitled](img/Untitled%2016.png)

## 3.5. Gia háº¡n VIP Member

TrÆ°á»ng há»£p Member háº¿t háº¡n sá»­ dá»¥ng VIP, Ä‘á»ƒ khÃ´ng pháº£i xÃ³a Member Ä‘i xong táº¡o láº¡i cÃ³ thá»ƒ sá»­ dá»¥ng chá»©c nÄƒng Gia háº¡n VIP, Ã¡p dá»¥ng cho cáº£ 2 loáº¡i VIP Member lÃ  theo sá»‘ ngÃ y Ä‘Æ°á»£c cáº¥p phÃ©p vÃ  theo Sá»‘ lÆ°á»£t truy váº¥n Ä‘Æ°á»£c cáº¥p.

![Untitled](img/Untitled%2017.png)

CÃº phÃ¡p nhÆ° sau:

```powershell
/vip ren <number> <key> <chat_id>
```

**Trong Ä‘Ã³:**

- `number`: Sá»‘ lÆ°á»£t truy váº¥n hoáº·c sá»‘ ngÃ y muá»‘n tÄƒng thÃªm cho Member
- `key`: KhÃ³a VT cá»§a Member. Sá»­ dá»¥ng `/vip dump` Ä‘á»ƒ xem thÃ´ng tin cÃ¡c Member mÃ¬nh Ä‘Ã£ cáº¥p VIP.
- `chat_id`: Telegram ID cá»§a Member. CÅ©ng sá»­ dá»¥ng `/vip dump` Ä‘á»ƒ xem thÃ´ng tin nÃ y.

**Demo:**

Giáº£ sá»­ hiá»‡n táº¡i Ä‘ang cáº¥p VIP cho 2 Member:

- member 1: CÃ³ ngÃ y háº¿t háº¡n VIP lÃ : `2021-11-11 21:04:19`
- member 2: CÃ³ tá»•ng sá»‘ lÆ°á»£t truy váº¥n lÃ : `20`

![Untitled](img/Untitled%2018.png)

Thá»±c hiá»‡n gia háº¡n `thÃªm 15 ngÃ y` cho Member 1 vÃ  `thÃªm 30 lÆ°á»£t` truy váº¥n cho Member 2:

![Untitled](img/Untitled%2019.png)

Kiá»ƒm tra káº¿t quáº£: Member 1 Ä‘Æ°á»£c gia háº¡n thÃªm tá»« `2021-11-11 21:04:19` lÃªn thÃ nh `2021-11-26 21:04:19`. CÃ²n Member 2 gia háº¡n thÃªm tá»« `20` lÃªn `50`:

![Untitled](img/Untitled%2020.png)

# 4. NhÃ³m chá»©c nÄƒng cho VIP Member

Äá»ƒ biáº¿t VIP Member hiá»‡n táº¡i Ä‘Æ°á»£c sá»­ dá»¥ng nhá»¯ng chá»©c nÄƒng gÃ¬. Báº¡n gá»­i má»™t trong cÃ¡c lá»‡nh sau cho Bot:

```bash
/vip
/vip help
```

![Untitled](img/Untitled%2021.png)

## 4.1. Download tá»‡p tin tá»« VT

Sau khi Member Ä‘Æ°á»£c cáº¥p quyá»n download tá»‡p tin tá»« VT. Member thá»±c hiá»‡n gá»­i lá»‡nh sau Ä‘á»ƒ nháº­n URL download tá»« Bot:

```bash
/vip dl <hash>
```

Trong Ä‘Ã³: `<hash>` lÃ  giÃ¡ trá»‹ bÄƒm cá»§a tá»‡p muá»‘n download. Hiá»‡n táº¡i Bot há»— trá»£ 3 loáº¡i bÄƒm lÃ : `MD5`, `SHA1`, `SHA256`

![img/Untitled%2022.png](img/Untitled%2022.png)

ğŸ’¡ Bot sáº½ gá»­i link download cho Member, link download cÃ³ hiá»‡u lá»±c trong vÃ²ng 60 phÃºt vÃ  khÃ´ng giá»›i háº¡n sá»‘ láº§n click download trong 60 phÃºt nÃ y. QuÃ¡ thá»i gian 60 phÃºt sáº½ khÃ´ng thá»ƒ download tá»‡p Ä‘Æ°á»£c ná»¯a.


## 4.2. VirusTotal Intelligence Search

VT Search Intelligence lÃ  tÃ­nh nÄƒng má»›i dÃ nh cho VIP Member. Member Ä‘Æ°á»£c cáº¥p quyá»n thá»±c hiá»‡n tÃ­nh nÄƒng nÃ y cÃ³ thá»ƒ Search nÃ¢ng cao nhÆ° tÃ­nh nÄƒng dÃ nh cho Admin. Äá»ƒ thá»±c hiá»‡n Search Intelligence, báº¡n gá»­i lá»‡nh theo cÃº phÃ¡p sau cho Bot:

```bash
/vip si <query>
```

CÃ¡ch thá»±c hiá»‡n vÃ  Demo xem pháº§n 5.3. VirusTotal Intelligence Search. **LÆ°u Ã½ sá»­ dá»¥ng Ä‘Ãºng cÃº phÃ¡p lÃ :** `/vip si <query>`. **KHÃ”NG** sá»­ dá»¥ng cÃº phÃ¡p `/etp si <query>` vÃ¬ cÃº phÃ¡p Ä‘Ã³ dÃ nh cho Admin.

# 5. Sá»­ dá»¥ng nhÃ³m tÃ­nh nÄƒng VT Enterprise

## 5.1. Kiá»ƒm tra khÃ³a Ä‘ang dÃ¹ng hay khÃ³a báº¥t ká»³

Kiá»ƒm tra thÃ´ng tin khÃ³a VT Ä‘ang sá»­ dá»¥ng

```bash
/etp info
```

![img/Untitled%2023.png](img/Untitled%2023.png)

Kiá»ƒm tra thÃ´ng tin má»™t khÃ³a VT báº¥t ká»³

```bash
/etp info <api_key>
```

![img/Untitled%2024.png](img/Untitled%2024.png)

## 5.2. Download tá»‡p tin tá»« VT

**Download tá»‡p tá»« VT**

```bash
/etp dl <hash/url>
```

**Trong Ä‘Ã³:**

- `<hash/url>`: GiÃ¡ trá»‹ bÄƒm (`MD5`, `SHA1`, `SHA256`) hoáº·c Ä‘á»‹a chá»‰ `URL` Ä‘áº¿n VirusTotal Sample. Chá»©c nÄƒng nÃ y há»— trá»£ gá»­i nhiá»u hash hoáº·c URL. tuy nhiÃªn khÃ´ng Ä‘Æ°á»£c vÆ°á»£t quÃ¡ 10.

![img/Untitled%2025.png](img/Untitled%2025.png)

ğŸ’¡ Vá»›i tá»‡p cÃ³ kÃ­ch tá»« 5 MB trá»Ÿ lÃªn. Bot sáº½ khÃ´ng thá»±c hiá»‡n download mÃ  sáº½ gá»­i link download. Link download cÃ³ hiá»‡u lá»±c trong 60 phÃºt.


**Nháº­n URL Download tá»‡p tá»« VT**

```bash
/etp dlu <hash/url>
```

Trong Ä‘Ã³:

- `<hash/url>`: GiÃ¡ trá»‹ bÄƒm (`MD5`, `SHA1`, `SHA256`) hoáº·c Ä‘á»‹a chá»‰ `URL` Ä‘áº¿n VirusTotal Sample. Chá»©c nÄƒng nÃ y há»— trá»£ gá»­i nhiá»u hash hoáº·c URL. tuy nhiÃªn khÃ´ng Ä‘Æ°á»£c vÆ°á»£t quÃ¡ 10.

![img/Untitled%2026.png](img/Untitled%2026.png)

## 5.3. VirusTotal Intelligence Search

**VirusTotal Intelligence Search** khÃ´ng chá»‰ Ã¡p dá»¥ng cho Ä‘á»‘i tÆ°á»£ng `Tá»‡p tin` mÃ  cÃ²n cho cáº£ `Domain`, `IP Adress` vÃ  `URL`. Hiá»‡n táº¡i **Bot Ä‘Ã£ há»— trá»£ Intelligence Search vá»›i `Tá»‡p tin`**.

Tham kháº£o cÃº phÃ¡p cÅ©ng nhÆ° cÃ¡ch thá»©c táº¡o cÃ¢u truy váº¥n cho **Intelligence Search:**

- **VirusTotal Intelligence Introduction**: [https://support.virustotal.com/hc/en-us/articles/360001387057-VirusTotal-Intelligence-Introduction](https://support.virustotal.com/hc/en-us/articles/360001387057-VirusTotal-Intelligence-Introduction)
- **File search modifiers**: [https://support.virustotal.com/hc/en-us/articles/360001385897-VT-Intelligence-search-modifiers](https://support.virustotal.com/hc/en-us/articles/360001385897-VT-Intelligence-search-modifiers)

**Demo 1:** Search cÃ¡c tá»‡p **PDF** cÃ³ kháº£ nÄƒng lÃ  **Malicious documents.** CÃ¡c tá»‡p nÃ y cÃ³ nhÃºng **JavaScript** bÃªn trong:

```bash
/etp si type:pdf tag:autoaction tag:js-embedded
```

![img/Untitled%2027.png](img/Untitled%2027.png)

**Demo 2:** Search cÃ¡c tá»‡p **Office Documents** Ä‘Æ°á»£c VT phÃ¡t hiá»‡n lÃ  cÃ³ mÃ£ khai thÃ¡c **Microsoft Word** . Lá»— há»•ng cÃ³ Ä‘á»‹nh danh lÃ : `CVE-2017-11882` hoáº·c `CVE-2018-0802`

```bash
/etp si type:doc AND (tag:cve-2017-11882 OR tag:cve-2018-0802)
```

![img/Untitled%2028.png](img/Untitled%2028.png)

ğŸ’¡ Theo máº·c Ä‘á»‹nh sá»‘ lÆ°á»£ng káº¿t quáº£ tráº£ vá» khi Intelligence Search lÃ : `05`


# 6. Sá»­ dá»¥ng Shodan Search Engine

Hiá»‡n táº¡i Threat Intelligence Bot Ä‘Ã£ tÃ­ch há»£p **Shodan Search Engine**. Sá»­ dá»¥ng lá»‡nh `/shodan` hoáº·c `/shodan help` Ä‘á»ƒ nháº­n trá»£ giÃºp cho nhÃ³m tÃ­nh nÄƒng nÃ y:

```bash
/shodan
/shodan help
```

![Untitled](img/Untitled%2029.png)

## 6.1. ThÃªm hoáº·c XÃ³a Shodan API Key

Äá»ƒ cÃ³ thá»ƒ thao tÃ¡c Ä‘Æ°á»£c vá»›i cÃ¡c chá»©c nÄƒng cá»§a Shodan, báº¡n cáº§n pháº£i thÃªm Shodan API Key. Sá»­ dá»¥ng lá»‡nh sau Ä‘á»ƒ thÃªm khÃ³a má»›i cho Shodan:

```bash
/shodan add <key>
```

![Untitled](img/Untitled%2030.png)

Hiá»‡n táº¡i tÃ­nh nÄƒng quáº£n lÃ½ khÃ³a cá»§a Shodan chá»‰ há»— trá»£ má»™t API Key cho má»™t ngÆ°á»i dÃ¹ng á»Ÿ má»™t thá»i Ä‘iá»ƒm. ChÆ°a há»— trá»£ má»™t ngÆ°á»i dÃ¹ng vá»›i nhiá»u Shodan API Key.

Äá»ƒ xÃ³a Shodan Key Ä‘Ã£ thÃªm trÆ°á»›c Ä‘Ã³, sá»­ dá»¥ng lá»‡nh sau:

```bash
/shodan del
```

![Untitled](img/Untitled%2031.png)

## 6.2. Kiá»ƒm tra thÃ´ng tin Shodan API Key

Äá»ƒ kiá»ƒm tra thÃ´ng tin Shodan API Key Ä‘ang sá»­ dá»¥ng. Báº¡n gá»­i lá»‡nh sau cho Bot:

```bash
/shodan info
```

![Untitled](img/Untitled%2032.png)

Äá»ƒ kiá»ƒm tra thÃ´ng tin má»™t Shodan API Key báº¥t ká»³. Báº¡n gá»­i lá»‡nh sau cho Bot:

```bash
/shodan info <key>
```

![Untitled](img/Untitled%2033.png)

TÃ­nh nÄƒng nÃ y sáº½ khÃ´ng yÃªu cáº§u ngÆ°á»i dÃ¹ng Bot pháº£i thiáº¿t láº­p Shodan Key trÆ°á»›c Ä‘Ã³.

## 6.3. TÃ¬m kiáº¿m má»™t IP hay má»™t Host trÃªn Shodan

Trong nhiá»u tÃ¬nh huá»‘ng cáº§n kiá»ƒm tra nhanh má»™t Ä‘á»‹a chá»‰ IP, cÃ³ thá»ƒ sá»­ dá»¥ng cÃ¡c **Threat Intelligence Platform** nhÆ° **Shodan** hoáº·c **VirusTotal**. ThÃ´ng tin thu Ä‘Æ°á»£c tá»« cÃ¡c platform nÃ y cÃ³ thá»ƒ há»¯u Ã­ch trong nhiá»u bÃ i toÃ¡n, má»™t sá»‘ thÃ´ng tin cÃ³ Ä‘Æ°á»£c nhÆ°: NhÃ  cung cáº¥p, Quá»‘c gia, cÃ¡c hostnames, domains liÃªn quan, cÃ¡c cá»•ng Ä‘ang má»Ÿ, tháº­m chÃ­ lÃ  lá»— há»•ng báº£o máº­t cá»§a dá»‹ch vá»¥ Ä‘ang cháº¡y,.v.v.. Äá»ƒ tÃ¬m kiáº¿m má»™t Ä‘á»‹a chá»‰ IP, báº¡n gá»­i lá»‡nh sau cho Bot:

```bash
/shodan ip <ip-address>
```

![Untitled](img/Untitled%2034.png)

![Untitled](img/Untitled%2035.png)

## 6.4. TÃ¬m kiáº¿m cÃ¡c SubDomain trÃªn Shodan

Äá»ƒ tÃ¬m kiáº¿m cÃ¡c SubDomain cá»§a má»™t Domain. Báº¡n gá»­i lá»‡nh sau cho Bot:

```bash
/shodan sub <domain>
```

![Untitled](img/Untitled%2036.png)

## 6.5. Domain to IP vÃ  IP to Domain

Äá»ƒ tÃ¬m kiáº¿m Ä‘á»‹a chá»‰ IP cá»§a má»™t hay nhiá»u Domain, báº¡n gá»­i lá»‡nh sau cho Bot:

```bash
/shodan dti <domain1,domain2>
```

![Untitled](img/Untitled%2037.png)

Äá»ƒ tÃ¬m kiáº¿m xem cÃ³ domain nÃ o Ä‘ang sá»­ dá»¥ng Ä‘á»‹a chá»‰ IP Ä‘Ã£ biáº¿t, báº¡n gá»­i lá»‡nh sau cho Bot:

```bash
/shodan itd <ip1,ip2>
```

![Untitled](img/Untitled%2038.png)

## 6.6. TÃ¬m kiáº¿m nÃ¢ng cao vá»›i cÃ¡c bá»™ lá»c trÃªn Shodan

ÄÃ¢y lÃ  tÃ­nh nÄƒng ráº¥t máº¡nh cá»§a Shodan Search Engine. Bot hiá»‡n táº¡i Ä‘Ã£ há»— trá»£ báº¡n gá»­i cÃ¡c truy váº¥n (query) kÃ¨m cÃ¡c bá»™ lá»c Ä‘á»ƒ tÃ¬m kiáº¿m trÃªn Shodan. Má»™t sá»‘ lÆ°u Ã½ nhÆ° sau khi gá»­i truy váº¥n cho Bot:

- CÃ ng sá»­ dá»¥ng nhiá»u bá»™ lá»c (Filter) thÃ¬ cÃ ng cho nhiá»u káº¿t quáº£ chÃ­nh xÃ¡c. NÃªn sá»­ dá»¥ng
- TÃ­nh nÄƒng nÃ y sáº½ máº¥t nhiá»u thá»i gian do pháº£i Ä‘á»£i mÃ¡y chá»§ cá»§a Shodan pháº£n há»“i. Trong lÃºc Ä‘á»£i, khÃ´ng nÃªn thao tÃ¡c gÃ¬ trÃ¡nh Bot quÃ¡ táº£i
- **KHÃ”NG** nÃªn chá»‰ sá»­ dá»¥ng **Má»˜T** bá»™ lá»c chung chung. VÃ­ dá»¥: `product:Apache`, `port:22`,.. vÃ¬ khi Ä‘Ã³ Shodan sáº½ tÃ¬m kiáº¿m ráº¥t lÃ¢u, máº¥t thá»i gian Ä‘á»£i pháº£n há»“i vÃ  dá»¯ liá»‡u tráº£ vá» sáº½ cá»±c lá»›n (Táº¥t nhiÃªn Ä‘Ã£ cÃ³ limit theo máº·c Ä‘á»‹nh nhÆ°ng sáº½ pháº£i Ä‘á»£i ráº¥t lÃ¢u). CÃ³ thá»ƒ dáº«n Ä‘áº¿n Time Out.
- NÃŠN káº¿t há»£p nhiá»u bá»™ lá»c Ä‘á»ƒ giáº£m táº£i cÅ©ng nhÆ° giáº£m thá»i gian chá» Ä‘á»£i. VÃ­ dá»¥: `product:Apache port:80 country:VN`
- CÃ¡c káº¿t quáº£ tráº£ vá» tá»« Shodan ráº¥t dÃ i dÃ²ng vÃ  nhiá»u, káº¿t quáº£ Bot hiá»ƒn thá»‹ lÃ  Ä‘Ã£ Ä‘Æ°á»£c lÆ°á»£c bá» vÃ  chá»‰ láº¥y nhá»¯ng thÃ´ng tin tá»•ng quÃ¡t.

Má»™t sá»‘ tÃ i liá»‡u tham kháº£o khi sá»­ dá»¥ng tÃ­nh nÄƒng Search nÃ¢ng cao:

1. Filter Reference: [https://www.shodan.io/search/filters](https://www.shodan.io/search/filters)
2. Search Query Examples: [https://www.shodan.io/search/examples](https://www.shodan.io/search/examples)
3. Facet Analysis: [https://beta.shodan.io/search/facet](https://beta.shodan.io/search/facet)

Äá»ƒ sá»­ dá»¥ng tÃ­nh nÄƒng tÃ¬m kiáº¿m nÃ¢ng cao vá»›i Shodan. Báº¡n gá»­i lá»‡nh sau cho Bot:

```bash
/shodan search <query>
```

**Demo 1:** TÃ¬m kiáº¿m cÃ¡c mÃ¡y chá»§ tá»“n táº¡i lá»— há»•ng báº£o máº­t cÃ³ Ä‘á»‹nh danh: [CVE-2019-19781](https://nvd.nist.gov/vuln/detail/CVE-2019-19781) táº¡i Viá»‡t Nam.

```bash
/shodan search vuln:CVE-2019-19781 country:VN
```

![Untitled](img/Untitled%2039.png)

**Demo 2:** TÃ¬m kiáº¿m cÃ¡c mÃ¡y chá»§ cháº¡y Apache trÃªn cá»•ng 80, cá»§a nhÃ  máº¡ng Viettel

```bash
/shodan search product:Apache port:80 country:"VN" org:"Viettel Group"
```

![Untitled](img/Untitled%2040.png)

![Untitled](img/Untitled%2041.png)

# 7. VT Hunting

Threat Intelligence Bot Ä‘Ã£ cÃ³ tÃ­nh nÄƒng má»›i cho phÃ©p ngÆ°á»i dÃ¹ng thá»±c hiá»‡n: Láº­p lá»‹ch, theo dÃµi cÃ¡c hash, search intelligence,.v.v.. theo Ä‘á»‹nh ká»³. VÃ  nháº­n thÃ´ng bÃ¡o khi cÃ³ káº¿t quáº£ tá»« Bot. ÄÃ¢y lÃ  má»™t tÃ­nh nÄƒng má»›i thay tháº¿ cho tÃ­nh nÄƒng [VT HUNTING (Retrohunt, Livehunt)](https://developers.virustotal.com/reference#retrohunt) cÃ³ sáºµn cá»§a VirusTotal, nÃ³ kháº¯c phá»¥c Ä‘Æ°á»£c cÃ¡c nhÆ°á»£c Ä‘iá»ƒm sau:

- Cáº£nh bÃ¡o trá»±c tiáº¿p Ä‘áº¿n ngÆ°á»i dÃ¹ng qua Telegram thay vÃ¬ qua Email vÃ¬ dá»… bá»‹ Ä‘Ã¡nh vÃ o Spam.
- KhÃ´ng bá»‹ lá»™ lá»t cÃ¡c Hunting Job vá»›i ngÆ°á»i khÃ¡c. VÃ¬ má»™t Private API key cÃ³ thá»ƒ Ä‘ang Ä‘Æ°á»£c sá»­ dá»¥ng bá»Ÿi nhiá»u ngÆ°á»i, nhá»¯ng ngÆ°á»i nÃ y cÃ³ thá»ƒ biáº¿t Ä‘c API Key nÃ y Ä‘ang thiáº¿t láº­p cÃ¡c Hunting Job nÃ o, dáº«n Ä‘áº¿n viá»‡c cÃ³ thá»ƒ sáº½ bá»‹ khÃ³a API Key.
- Linh Ä‘á»™ng vÃ  tÃ¹y biáº¿n cao: Nhiá»u cÃ¡ch thá»©c Monitor (Hash, Query), Láº­p lá»‹ch theo thá»i gian tÃ¹y Ã½,.v.v...

Äá»ƒ nháº­n Menu trá»£ giÃºp tá»« Bot cho tÃ­nh nÄƒng VT Hunting. Báº¡n gá»­i lá»‡nh sau cho Bot:

```bash
/hunt
# Hoáº·c
/hunt help
```

![Untitled](img/Untitled%2042.png)

## 7.1. Khá»Ÿi táº¡o cÃ¡c Hunting Job

Hiá»‡n táº¡i chá»©c nÄƒng VT Hunting há»— trá»£ táº¡o **03** loáº¡i Hunting Job sau:

1. **Hashes Hunting Job:** Táº¡o Job vá»›i cÃ¡c Hashes cáº§n theo dÃµi má»™t cÃ¡ch thá»§ cÃ´ng. CÃ¡c Hashes ngÄƒn cÃ¡ch nhau báº±ng dáº¥u `khoáº£ng tráº¯ng` hoáº·c `xuá»‘ng dÃ²ng`
2. **URL Hunting Job:** Táº¡o Job theo dÃµi má»™t URL. URL nÃ y chá»©a cÃ¡c Hashes vÃ  sá»‘ lÆ°á»£ng cÃ¡c Hashes cÃ³ thá»ƒ thay Ä‘á»•i theo thá»i gian
3. **Search Query Hunting Job:** Táº¡o Job thá»±c hiá»‡n truy váº¥n nÃ¢ng cao (Search Intelligence). TÃ­nh hiá»‡u quáº£ phá»¥ thuá»™c vÃ o Ä‘á»™ sÃ¡ng táº¡o cá»§a ngÆ°á»i viáº¿t cÃ¢u truy váº¥n lÃªn VirusTotal.

ğŸ‘· **Táº¡o Hash Hunting Job**

```bash
/hunt hash <hash1 hash2 hash3>
```

![Untitled](img/Untitled%2043.png)

ğŸ‘· **Táº¡o URL Hunting Job**

```bash
/hunt url <url>
```

Giáº£ sá»­ ta cáº§n Monitor má»™t URL chá»©a cÃ¡c hash nhÆ° sau: [https://binary.ninja/js/hashes.js](https://binary.ninja/js/hashes.js)

![Untitled](img/Untitled%2044.png)

![Untitled](img/Untitled%2045.png)

ğŸ‘· **Táº¡o Search Query Hunting Job**

```bash
/hunt si <query>
```

![Untitled](img/Untitled%2046.png)

**ğŸ” BÃ¢y giá» Ä‘á»ƒ xem láº¡i cÃ¡c Hunting Job báº¡n Ä‘Ã£ táº¡o trÆ°á»›c Ä‘Ã³. Gá»­i lá»‡nh sau cho Bot:**

```bash
/hunt dump
# Hoáº·c
/hunt dump <hunt_id>
```

![Untitled](img/Untitled%2047.png)

Vá»›i lá»‡nh `/hunt dump` chÃºng ta chá»‰ cÃ³ thá»ƒ xem cáº¥u hÃ¬nh ngáº¯n gá»n cá»§a cÃ¡c Hunting Job Ä‘Ã£ táº¡o. Äá»ƒ xem cáº¥u hÃ¬nh chi tiáº¿t hÆ¡n. Sá»­ dá»¥ng lá»‡nh: `/hunt dump <hunt_id>`

![Untitled](img/Untitled%2048.png)

**Giáº£i thÃ­ch má»™t vÃ i thÃ´ng sá»‘:**

- `id`: HuntID cá»§a má»™t Hunting Job, con sá»‘ nÃ y lÃ  duy nháº¥t. Sinh tá»± Ä‘á»™ng vÃ  tráº£ vá» cho ngÆ°á»i dÃ¹ng sau khi Hunting Job Ä‘Æ°á»£c táº¡o
- `type`: Hunting Job Type: hash, url hoáº·c query
- `create_time`: Thá»i gian Hunting Job Ä‘Æ°á»£c táº¡o
- `status`: Máº·c Ä‘á»‹nh tráº¡ng thÃ¡i cá»§a Hunting Job lÃ  `OFF` sau khi Ä‘Æ°á»£c táº¡o. Khi thiáº¿t láº­p thá»i gian cháº¡y thÃ¬ nÃ³ sáº½ chuyá»ƒn thÃ nh `ON`.
- `run_at`: Thá»i gian cháº¡y trong ngÃ y cá»§a Hunting Job. Khi chÆ°a thiáº¿t láº­p thÃ¬ giÃ¡ trá»‹ nÃ y sáº½ lÃ  trá»‘ng.
- `num_of_hashes` vÃ  `content`: Sá»‘ lÆ°á»£ng cÃ¡c hash vÃ  ná»™i dung cá»¥ thá»ƒ cÃ¡c hashes Ä‘Ã£ thÃªm.
- `source`: Cho biáº¿t Hunting Job nÃ y Ä‘Æ°á»£c táº¡o thá»§ cÃ´ng (manual) hay Ä‘Æ°á»£c láº¥y tá»« má»™t URL
- `last_run`: Thá»i Ä‘iá»ƒm láº§n cuá»‘i cÃ¹ng Hunting Job nÃ y cháº¡y. Máº·c Ä‘á»‹nh giÃ¡ trá»‹ `1970-01-01 07:00:00` cho biáº¿t Job nÃ y chÆ°a Ä‘Æ°á»£c cháº¡y láº§n nÃ o.

TrÆ°á»ng há»£p muá»‘n xem láº¡i táº¥t cáº£ cÃ¡c hashes Ä‘ang theo dÃµi vÃ  cÃ¡c hashes Ä‘Ã£ tÃ¬m tháº¥y mÃ  khÃ´ng cáº§n nháº­p vÃ o **HuntID**. Báº¡n gá»­i lá»‡nh sau cho Bot:

```bash
/hunt export
```

![Untitled](img/Untitled%2049.png)

**Trong Ä‘Ã³:**

- `hashes_monitor`: Sá»‘ hashes Ä‘ang theo dÃµi trÃªn VT
- `hashes_found`: Sá»‘ hashes Ä‘Ã£ tÃ¬m tháº¥y trÃªn VT

Náº¿u sá»‘ lÆ°á»£ng hashes quÃ¡ nhiá»u. Bot sáº½ export sang dáº¡ng tá»‡p tin `*.json` vÃ  gá»­i cho báº¡n.

VÃ  cuá»‘i cÃ¹ng Ä‘á»ƒ xÃ³a má»™t Hunting Job. Báº¡n gá»­i lá»‡nh sau cho Bot:

```bash
/hunt del <hunt_id>
```

![Untitled](img/Untitled%2050.png)

## 7.2. Cáº¥u hÃ¬nh vÃ  khá»Ÿi cháº¡y cÃ¡c Hunting Job

**7.2.1 Cáº¥u hÃ¬nh (Láº­p lá»‹ch) thá»i gian cháº¡y cho cÃ¡c Hunting Job**

TrÆ°á»›c tiÃªn, ta xuáº¥t thÃ´ng tin cÃ¡c Hunting Job Ä‘Ã£ táº¡o, xem cáº¥u hÃ¬nh hiá»‡n táº¡i vÃ  cÅ©ng Ä‘á»ƒ láº¥y HuntID cá»§a cÃ¡c Job.

![Untitled](img/Untitled%2051.png)

**â²ï¸ Láº­p lá»‹ch cháº¡y 01 láº§n má»—i ngÃ y**

```bash
/hunt stime <hunt_id> <time>
```

Demo: Äáº·t lá»‹ch cháº¡y Hunting Job vÃ o `01 giá» 15 phÃºt` sÃ¡ng sá»›m má»—i ngÃ y.

![Untitled](img/Untitled%2052.png)

**â²ï¸ Láº­p lá»‹ch cháº¡y nhiá»u láº§n má»—i ngÃ y**

```bash
/hunt stime <hunt_id> <time1 time2 time3>
```

Demo: Äáº·t lá»‹ch cháº¡y Hungting Job vÃ o lÃºc: `02 giá»` sÃ¡ng, `11 giá» 30 phÃºt` trÆ°a vÃ  `23 giá» 15` phÃºt tá»‘i cá»§a má»—i ngÃ y.

![Untitled](img/Untitled%2053.png)

CÃ¹ng xem láº¡i cÃ¡c má»‘c thá»i gian Ä‘Ã£ cáº¥u hÃ¬nh cho Hunting Job: Äá»ƒ Ã½ thÃ´ng sá»‘ cáº¥u hÃ¬nh: `run_at` Ä‘Ã£ Ä‘Æ°á»£c thay Ä‘á»•i.

![Untitled](img/Untitled%2054.png)

**7.2.2. Khá»Ÿi cháº¡y cÃ¡c Hungtin Job**

Khi Ä‘Ã£ hoÃ n táº¥t viá»‡c cáº¥u hÃ¬nh cÃ¡c Hunting Job theo Ã½ muá»‘n. Báº¡n cÃ³ thá»ƒ báº¯t Ä‘áº§u cho cháº¡y cÃ¡c Hungtin Job nÃ y. NgoÃ i ra, Bot cÅ©ng há»— trá»£ ngÆ°á»i dÃ¹ng kiá»ƒm tra, theo dÃµi cÃ¡c Hunting Job Ä‘ang cháº¡y, Ä‘á»“ng thá»i cÃ³ thá»ƒ buá»™c dá»«ng cÃ¡c Hunting Job nÃ y theo yÃªu cáº§u cá»§a ngÆ°á»i dÃ¹ng.

**ğŸ›ï¸ Khá»Ÿi cháº¡y cÃ¡c Hunting Job - START**

```bash
/hunt start
```

![Untitled](img/Untitled%2055.png)

**ğŸ›ï¸ Kiá»ƒm tra tráº¡ng thÃ¡i cÃ¡c Hunting Job - STATUS**

```bash
/hunt status
```

![Untitled](img/Untitled%2056.png)

Vá»›i Hunting Job cÃ³ ID `1631876489`. Do chÃºng ta trÆ°á»›c Ä‘Ã³ Ä‘Ã£ láº­p lá»‹ch cháº¡y á»Ÿ cÃ¡c khoáº£ng thá»i gian `11:30:00`, `02:00:00` vÃ  `23:15:00`. NÃªn khi kiá»ƒm tra vá»›i `/hunt status` sáº½ tháº¥y xuáº¥t hiá»‡n thÃ´ng sá»‘ `number` tráº£ vá» `3`.

**ğŸ›ï¸ Buá»™c dá»«ng cÃ¡c Hunting Job - STOP**

```bash
/hunt stop
```

![Untitled](img/Untitled%2057.png)

**ğŸ° Nháº­n káº¿t quáº£ sau khi cháº¡y cá»§a Hunting Job**

Sau khi Ä‘Ã£ láº­p lá»‹ch cÃ¡c Hunting Job cháº¡y vÃ o cÃ¡c khoáº£ng thá»i gian theo Ã½ muá»‘n cá»§a báº¡n. CÃ´ng viá»‡c cÃ²n láº¡i lÃºc nÃ y chá»‰ lÃ  chá» Ä‘á»£i. Giáº£ sá»­ báº¡n Ä‘áº·t lá»‹ch cho Job cháº¡y vÃ o lÃºc Ä‘Ãªm, khi Ä‘Ã³ báº¡n Ä‘Ã£ Ä‘i ngá»§. Khi Ä‘áº¿n thá»i Ä‘iá»ƒm Ä‘Ã£ láº­p lá»‹ch, Bot cháº¡y láº¥y káº¿t quáº£ cÃ¡c hash nÃ³ tÃ¬m tháº¥y vÃ  náº¿u cÃ³ nÃ³ sáº½ gá»­i tin nháº¯n cho báº¡n.

LÆ°u Ã½ ráº±ng, cÃ¡c hashes sáº½ Ä‘Æ°á»£c lÆ°u vÃ o CÆ¡ sá»Ÿ dá»¯ liá»‡u Ä‘á»ƒ thuáº­n tiá»‡n cho viá»‡c tra cá»©u sau nÃ y vÃ  cÃ¡c hash mÃ  Bot Ä‘Ã£ tÃ¬m tháº¥y nÃ³ sáº½ khÃ´ng cáº£nh bÃ¡o láº¡i Ä‘áº¿n báº¡n á»Ÿ cÃ¡c láº§n cháº¡y vÃ o hÃ´m sau.

![Untitled](img/Untitled%2058.png)

**ğŸ° Kiá»ƒm tra láº¡i káº¿t quáº£ cá»§a cÃ¡c láº§n cháº¡y Hunting Job**

```bash
/hunt log <hunt_id>
```

![Untitled](img/Untitled%2059.png)

## 7.3. Cáº­p nháº­t cÃ¡c thay Ä‘á»•i cá»§a Hunting Job

**ğŸ”¨ Cáº­p nháº­t thÃªm cÃ¡c Hashes**

Äá»ƒ cáº­p nháº­t thÃªm cÃ¡c Hashes cá»§a má»™t **Hunting Job Hash**. Báº¡n gá»­i lá»‡nh sau cho Bot:

```bash
/hunt update <hunt_id> <hashes>
```

![Untitled](img/Untitled%2060.png)

HÃ¬nh trÃªn cho tháº¥y, tÃ´i muá»‘n cáº­p nháº­t thÃªm `7 hash` má»›i vÃ o má»™t Hunting Job Ä‘Ã£ táº¡o trÆ°á»›c Ä‘Ã³, vÃ  trong sá»‘ Ä‘Ã³ cÃ³ `2 hash` Ä‘Ã£ tá»“n táº¡i trÆ°á»›c Ä‘Ã³ rá»“i. Váº­y sáº½ chá»‰ cÃ³ `5 hash` má»›i Ä‘Æ°á»£c thÃªm.

![Untitled](img/Untitled%2061.png)

Vá»›i cÃ¡c **Hunting Job URL**, qua thá»i gian cÃ³ thá»ƒ sáº½ Ä‘Æ°á»£c thÃªm má»›i cÃ¡c hash. Äá»ƒ cáº­p nháº­t, báº¡n gá»­i lá»‡nh sau cho Bot, nÃ³ sáº½ tá»± Ä‘á»™ng truy váº¥n Ä‘áº¿n URL vÃ  trÃ­ch xuáº¥t cÃ¡c hashes má»›i Ä‘Æ°á»£c thÃªm:

```bash
/hunt update <hunt_id>
```

![Untitled](img/Untitled%2062.png)

![Untitled](img/Untitled%2063.png)

**ğŸ”¨ Cáº­p nháº­t thá»i gian cháº¡y cá»§a cÃ¡c Hunting Job**

Äá»ƒ thay Ä‘á»•i thá»i gian cháº¡y (láº­p lá»‹ch) cá»§a cÃ¡c Hunting Job. Báº¡n thá»±c hiá»‡n tÆ°Æ¡ng tá»± nhÆ° lÃºc thiáº¿t láº­p thá»i gian. LÃºc nÃ y má»‘c thá»i gian má»›i báº¡n thiáº¿t láº­p sáº½ ghi Ä‘Ã¨ lÃªn cÃ¡c má»‘c thá»i gian cÅ©. CÃº phÃ¡p:

```bash
/hunt stime <hunt_id> <times>
```

VÃ  cuá»‘i cÃ¹ng Ä‘á»ƒ Ã¡p dá»¥ng cÃ¡c thay Ä‘á»•i. Báº¡n cáº§n dá»«ng cÃ¡c Hunting Job Ä‘ang cháº¡y sau Ä‘Ã³ khá»Ÿi Ä‘á»™ng láº¡i chÃºng.

```bash
/hunt stop
/hunt start
```